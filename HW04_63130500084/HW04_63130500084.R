# Import library
library(dplyr)
library(stringr)
library(readr)
library(ggplot2)
library(DescTools)
library(forcats)
library(scales)
library(assertive)
library(tidyr)
#Dataset
superstore <- read_csv("https://raw.githubusercontent.com/sit-2021-int214/027-Quickest-Electric-Cars/main/assignment/Homework04/HW04_63130500084/train.csv")

#explore dataset
View(superstore)
glimpse(superstore)
#Dataset ???????????????????????????????????????????????????????????? 9,800 rows ???????????????????????????????????? 18 columns


#PART2 learning function
# Package `dplyr` 
#select() : ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
superstore %>% select(`Customer Name`, Country , City,`Order ID`)

# Package `forcats`
#fct_infreq() : ??????????????????????????????????????????????????????????????????????????????????????????
superstore %>% mutate(state = fct_infreq(State)) %>% count(state)


#PART3
#1. ?????????????????????????????????????????????????????????????????????????????????????????????
superstore %>% group_by(City) %>% summarise("total" = length(City))
#2. ???????????????????????????????????????????????????????????????????????????????????????????????????
CustomerMostBuy <- superstore %>% select(`Customer Name`,`Customer ID`,Sales)%>% filter(superstore$Sales == max(superstore$Sales));
CustomerMostBuy
#3. ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
superstore$Region <- as.factor(superstore$Region)
summary(superstore$Region)
#4. ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? distinct
superstore %>% distinct(Country,City)
#5. ???????????????????????????????????????????????????????????????????????????????????????????????? 5 ???????????????????????????
superstore$`Order Date` <- as.Date(as.character(superstore$`Order Date`),"%d/%m/%Y")
class(superstore$`Order Date`)

superstore$OrderMonth <- format(superstore$`Order Date`, "%m") 
Top5OrderMonth <- superstore %>% select(OrderMonth) %>% count(OrderMonth) %>% arrange(desc(n)) %>% slice(1:5)
as_tibble(Top5OrderMonth)
#6. ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
superstore %>% group_by(Category) %>% select(Category,Sales) %>% summarise(total = sum(Sales))


#PART4
